{% extends "base.html" %}

{% block content %}
<div class="row">
    <div class="col-lg-10 mx-auto">
        {% if not user %}
        <div class="card shadow-sm mb-4 welcome-card">
            <div class="card-body text-center py-4">
                <h4 class="text-muted mb-3">üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –†–µ—à–µ–±–Ω–∏–∫!</h4>
                <p class="lead mb-4">
                    –ü–æ–ª—É—á–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ä–µ—à–µ–Ω–∏—è–º –∏ –¥–µ–ª–∏—Ç–µ—Å—å —Å–≤–æ–∏–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏.<br>
                    –ë—ã—Å—Ç—Ä–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∑–∞ 30 —Å–µ–∫—É–Ω–¥!
                </p>
                <div class="d-flex justify-content-center gap-3 flex-wrap">
                    <a href="/register" class="btn btn-success btn-lg px-4">
                        <i class="fas fa-user-plus me-2"></i>–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç
                    </a>
                    <a href="/login" class="btn btn-outline-secondary btn-lg px-4">
                        <i class="fas fa-sign-in-alt me-2"></i>–í–æ–π—Ç–∏
                    </a>
                </div>
                <p class="text-muted mt-4 small">
                    –ü–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤—ã —Å–º–æ–∂–µ—Ç–µ:
                    <span class="d-block mt-2">
                        <i class="fas fa-check-circle text-success me-1"></i>–ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è
                        <i class="fas fa-check-circle text-success mx-3"></i>–ó–∞–≥—Ä—É–∂–∞—Ç—å –æ—Ç–≤–µ—Ç—ã
                        <i class="fas fa-check-circle text-success"></i>–ö–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å
                    </span>
                </p>
            </div>
        </div>
        {% endif %}

        {% if problems %}
            {% for grade, chapters in problems.items() %}
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center py-3">
                    <h4 class="mb-0">{{ grade }} </h4>
                    {% if user %}
                    <div class="d-flex gap-2">
                        <a href="/add-problem?grade={{ grade }}"
                           class="btn btn-light btn-sm"
                           title="–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ä–∞–∑–¥–µ–ª">
                            <i class="fas fa-plus"></i> –†–∞–∑–¥–µ–ª
                        </a>
                        <a href="/add-problem?grade={{ grade }}"
                           class="btn btn-light btn-sm"
                           title="–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É">
                            <i class="fas fa-plus"></i> –ó–∞–¥–∞—á—É
                        </a>
                    </div>
                    {% endif %}
                </div>

                <div class="card-body">
                    {% for chapter, numbers in chapters.items() %}
                    <div class="mb-4">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h5 class="text-primary">{{ chapter }}</h5>
                            {% if user %}
                            <a href="/add-problem?grade={{ grade }}&chapter={{ chapter|urlencode }}"
                               class="btn btn-outline-primary btn-sm">
                                <i class="fas fa-plus"></i>
                            </a>
                            {% endif %}
                        </div>
                        <div class="d-flex flex-wrap gap-2">
                            {% for number in numbers|sort %}
                            <a href="/problem/{{ grade }}-{{ chapter|replace(' ', '_') }}-{{ number }}"
                               class="btn btn-outline-primary rounded-pill">
                                ‚Ññ{{ number }}
                            </a>
                            {% endfor %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="card shadow-sm">
                <div class="card-body text-center py-5">
                    <h4 class="text-muted mb-4">–ü–æ–∫–∞ –Ω–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á</h4>
                    {% if user %}
                    <a href="/add-problem" class="btn btn-primary btn-lg">
                        <i class="fas fa-plus"></i> –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—ã–π —Ä–∞–∑–¥–µ–ª
                    </a>
                    {% else %}
                    <div class="alert alert-info">
                        –í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –¥–æ–±–∞–≤–ª—è—Ç—å –∑–∞–¥–∞—á–∏
                    </div>
                    {% endif %}
                </div>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}